From: Nikolay Sivov <nsivov@codeweavers.com>
Subject: [PATCH] mfplat: Add Media Engine attributes to tracing.
Message-Id: <20200525191423.1025170-1-nsivov@codeweavers.com>
Date: Mon, 25 May 2020 22:14:23 +0300

Signed-off-by: Nikolay Sivov <nsivov@codeweavers.com>
---
 dlls/mfplat/main.c | 32 +++++++++++++++++++++++++++++++-
 1 file changed, 31 insertions(+), 1 deletion(-)

diff --git a/dlls/mfplat/main.c b/dlls/mfplat/main.c
index 0a5958acb2d..ea6a0659c5c 100644
--- a/dlls/mfplat/main.c
+++ b/dlls/mfplat/main.c
@@ -39,6 +39,7 @@
 
 #include "mfplat_private.h"
 #include "mfreadwrite.h"
+#include "mfmediaengine.h"
 #include "propvarutil.h"
 #include "strsafe.h"
 
@@ -1559,6 +1560,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_MPEG2_TIMECODE),
         X(MF_PMP_SERVER_CONTEXT),
         X(MFT_SUPPORT_DYNAMIC_FORMAT_CHANGE),
+        X(MF_MEDIA_ENGINE_TRACK_ID),
         X(MF_MT_CUSTOM_VIDEO_PRIMARIES),
         X(MF_MT_TIMESTAMP_CAN_BE_DTS),
         X(MFT_CODEC_MERIT_Attribute),
@@ -1566,10 +1568,12 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_LOW_LATENCY),
         X(MF_READWRITE_ENABLE_HARDWARE_TRANSFORMS),
         X(MF_MT_MPEG2_FLAGS),
+        X(MF_MEDIA_ENGINE_AUDIO_CATEGORY),
         X(MF_MT_PIXEL_ASPECT_RATIO),
         X(MF_TOPOLOGY_ENABLE_XVP_FOR_PLAYBACK),
         X(MFT_CONNECTED_STREAM_ATTRIBUTE),
         X(MF_MT_REALTIME_CONTENT),
+        X(MF_MEDIA_ENGINE_CONTENT_PROTECTION_FLAGS),
         X(MF_MT_WRAPPED_TYPE),
         X(MF_MT_DRM_FLAGS),
         X(MF_MT_AVG_BITRATE),
@@ -1583,6 +1587,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_SOURCE_READER_ENABLE_ADVANCED_VIDEO_PROCESSING),
         X(MF_MT_AM_FORMAT_TYPE),
         X(MF_SESSION_APPROX_EVENT_OCCURRENCE_TIME),
+        X(MF_MEDIA_ENGINE_SYNCHRONOUS_CLOSE),
         X(MF_MT_H264_MAX_MB_PER_SEC),
         X(MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_MAX_BUFFERS),
         X(MF_MT_AUDIO_BLOCK_ALIGNMENT),
@@ -1597,10 +1602,13 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_H264_SUPPORTED_SLICE_MODES),
         X(MF_PD_LAST_MODIFIED_TIME),
         X(MF_PD_PLAYBACK_ELEMENT_ID),
+        X(MF_MEDIA_ENGINE_BROWSER_COMPATIBILITY_MODE_IE9),
         X(MF_MT_ALL_SAMPLES_INDEPENDENT),
         X(MF_PD_PREFERRED_LANGUAGE),
         X(MF_PD_PLAYBACK_BOUNDARY_TIME),
+        X(MF_MEDIA_ENGINE_TELEMETRY_APPLICATION_ID),
         X(MF_ACTIVATE_MFT_LOCKED),
+        X(MF_MEDIA_ENGINE_VIDEO_OUTPUT_FORMAT),
         X(MF_SOURCE_READER_ENABLE_VIDEO_PROCESSING),
         X(MF_MT_FRAME_SIZE),
         X(MF_MT_H264_SIMULCAST_SUPPORT),
@@ -1612,9 +1620,13 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_PALETTE),
         X(MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_PROVIDER_DEVICE_ID),
         X(MF_TOPOLOGY_STATIC_PLAYBACK_OPTIMIZATIONS),
+        X(MF_MEDIA_ENGINE_NEEDKEY_CALLBACK),
         X(MF_MT_GEOMETRIC_APERTURE),
         X(MF_MT_ORIGINAL_WAVE_FORMAT_TAG),
         X(MF_MT_DV_AAUX_SRC_PACK_1),
+        X(MF_MEDIA_ENGINE_STREAM_CONTAINS_ALPHA_CHANNEL),
+        X(MF_MEDIA_ENGINE_MEDIA_PLAYER_MODE),
+        X(MF_MEDIA_ENGINE_EXTENSION),
         X(MF_MT_DEFAULT_STRIDE),
         X(MF_MT_ARBITRARY_FORMAT),
         X(MF_TRANSFORM_CATEGORY_Attribute),
@@ -1632,12 +1644,14 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_DEVSOURCE_ATTRIBUTE_FRIENDLY_NAME),
         X(MF_MT_VIDEO_ROTATION),
         X(MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_AUDCAP_SYMBOLIC_LINK),
+        X(MF_MEDIA_ENGINE_BROWSER_COMPATIBILITY_MODE_IE11),
         X(MF_MT_USER_DATA),
         X(MF_MT_MIN_MASTERING_LUMINANCE),
         X(MF_EVENT_STREAM_METADATA_SYSTEMID),
         X(MF_MT_AUDIO_CHANNEL_MASK),
         X(MF_SOURCE_READER_DISCONNECT_MEDIASOURCE_ON_SHUTDOWN),
         X(MF_READWRITE_DISABLE_CONVERTERS),
+        X(MF_MEDIA_ENGINE_BROWSER_COMPATIBILITY_MODE_IE_EDGE),
         X(MF_MT_MINIMUM_DISPLAY_APERTURE),
         X(MFSampleExtension_Token),
         X(MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_CATEGORY),
@@ -1646,12 +1660,13 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_DISABLE_FRAME_CORRUPTION_INFO),
         X(MF_TOPOLOGY_ENUMERATE_SOURCE_TYPES),
         X(MF_MT_VIDEO_NO_FRAME_ORDERING),
+        X(MF_MEDIA_ENGINE_PLAYBACK_VISUAL),
         X(MF_MT_VIDEO_CHROMA_SITING),
         X(MF_AUDIO_RENDERER_ATTRIBUTE_STREAM_CATEGORY),
         X(MFSampleExtension_3DVideo_SampleFormat),
         X(MF_MT_H264_RESOLUTION_SCALING),
-        X(MF_MT_MPEG2_LEVEL),
         X(MF_MT_VIDEO_LEVEL),
+        X(MF_MT_MPEG2_LEVEL),
         X(MF_SAMPLEGRABBERSINK_SAMPLE_TIME_OFFSET),
         X(MF_MT_SAMPLE_SIZE),
         X(MF_MT_AAC_PAYLOAD_TYPE),
@@ -1682,6 +1697,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_BYTESTREAM_ORIGIN_NAME),
         X(MF_BYTESTREAM_CONTENT_TYPE),
         X(MF_MT_DEPTH_MEASUREMENT),
+        X(MF_MEDIA_ENGINE_COMPATIBILITY_MODE_WIN10),
         X(MF_MT_VIDEO_3D_NUM_VIEWS),
         X(MF_BYTESTREAM_DURATION),
         X(MF_SD_SAMI_LANGUAGE),
@@ -1701,6 +1717,8 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_VIDEO_3D_FIRST_IS_LEFT),
         X(MFT_DECODER_FINAL_VIDEO_RESOLUTION_HINT),
         X(MF_PD_ADAPTIVE_STREAMING),
+        X(MF_MEDIA_ENGINE_SOURCE_RESOLVER_CONFIG_STORE),
+        X(MF_MEDIA_ENGINE_COMPATIBILITY_MODE_WWA_EDGE),
         X(MF_MT_H264_SUPPORTED_USAGES),
         X(MFT_PREFERRED_OUTPUTTYPE_Attribute),
         X(MFSampleExtension_Timestamp),
@@ -1708,6 +1726,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_SUBTYPE),
         X(MF_TRANSFORM_ASYNC),
         X(MF_TOPONODE_STREAMID),
+        X(MF_MEDIA_ENGINE_PLAYBACK_HWND),
         X(MF_TOPONODE_NOSHUTDOWN_ON_REMOVE),
         X(MF_MT_VIDEO_LIGHTING),
         X(MF_SD_MUTUALLY_EXCLUSIVE),
@@ -1722,9 +1741,11 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_SINK_WRITER_D3D_MANAGER),
         X(MFSampleExtension_3DVideo),
         X(MF_MT_H264_USAGE),
+        X(MF_MEDIA_ENGINE_EME_CALLBACK),
         X(MF_EVENT_SOURCE_FAKE_START),
         X(MF_EVENT_SOURCE_PROJECTSTART),
         X(MF_EVENT_SOURCE_ACTUAL_START),
+        X(MF_MEDIA_ENGINE_CONTENT_PROTECTION_MANAGER),
         X(MF_MT_AUDIO_SAMPLES_PER_BLOCK),
         X(MFT_ENUM_HARDWARE_URL_Attribute),
         X(MF_SOURCE_READER_ASYNC_CALLBACK),
@@ -1741,6 +1762,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_SPATIAL_AUDIO_MAX_METADATA_ITEMS),
         X(MF_MT_MPEG2_ONE_FRAME_PER_PACKET),
         X(MF_MT_INTERLACE_MODE),
+        X(MF_MEDIA_ENGINE_CALLBACK),
         X(MF_MT_VIDEO_RENDERER_EXTENSION_PROFILE),
         X(MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_HW_SOURCE),
         X(MF_MT_AUDIO_PREFER_WAVEFORMATEX),
@@ -1767,9 +1789,11 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_EVENT_START_PRESENTATION_TIME),
         X(MF_EVENT_SESSIONCAPS),
         X(MF_EVENT_PRESENTATION_TIME_OFFSET),
+        X(MF_MEDIA_ENGINE_AUDIO_ENDPOINT_ROLE),
         X(MF_EVENT_SESSIONCAPS_DELTA),
         X(MF_EVENT_START_PRESENTATION_TIME_AT_OUTPUT),
         X(MFSampleExtension_DecodeTimestamp),
+        X(MF_MEDIA_ENGINE_COMPATIBILITY_MODE),
         X(MF_MT_VIDEO_H264_NO_FMOASO),
         X(MF_MT_AVG_BIT_ERROR_RATE),
         X(MF_MT_VIDEO_PRIMARIES),
@@ -1777,7 +1801,9 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_H264_RATE_CONTROL_MODES),
         X(MF_DEVSOURCE_ATTRIBUTE_SOURCE_TYPE_VIDCAP_SYMBOLIC_LINK),
         X(MF_READWRITE_D3D_OPTIONAL),
+        X(MF_MEDIA_ENGINE_DXGI_MANAGER),
         X(MF_READWRITE_MMCSS_CLASS_AUDIO),
+        X(MF_MEDIA_ENGINE_COREWINDOW),
         X(MF_SOURCE_READER_DISABLE_CAMERA_PLUGINS),
         X(MF_MT_MPEG4_TRACK_TYPE),
         X(MF_MT_PAN_SCAN_APERTURE),
@@ -1785,6 +1811,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_ORIGINAL_4CC),
         X(MF_PD_AUDIO_ISVARIABLEBITRATE),
         X(MF_AUDIO_RENDERER_ATTRIBUTE_FLAGS),
+        X(MF_MEDIA_ENGINE_BROWSER_COMPATIBILITY_MODE),
         X(MF_AUDIO_RENDERER_ATTRIBUTE_SESSION_ID),
         X(MF_MT_MPEG2_CONTENT_PACKET),
         X(MFT_PROCESS_LOCAL_Attribute),
@@ -1793,6 +1820,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_MT_VIDEO_NOMINAL_RANGE),
         X(MF_MT_AAC_AUDIO_PROFILE_LEVEL_INDICATION),
         X(MF_MT_MPEG_SEQUENCE_HEADER),
+        X(MF_MEDIA_ENGINE_OPM_HWND),
         X(MF_MT_AUDIO_SAMPLES_PER_SECOND),
         X(MF_MT_SPATIAL_AUDIO_DATA_PRESENT),
         X(MF_MT_FRAME_RATE),
@@ -1822,6 +1850,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_TOPOLOGY_DXVA_MODE),
         X(MF_TOPONODE_LOCKED),
         X(MF_TOPONODE_WORKQUEUE_ID),
+        X(MF_MEDIA_ENGINE_CONTINUE_ON_CODEC_ERROR),
         X(MF_TOPONODE_WORKQUEUE_MMCSS_CLASS),
         X(MF_TOPONODE_DECRYPTOR),
         X(MF_EVENT_DO_THINNING),
@@ -1829,6 +1858,7 @@ const char *debugstr_attr(const GUID *guid)
         X(MF_TOPOLOGY_HARDWARE_MODE),
         X(MF_SOURCE_READER_DISABLE_DXVA),
         X(MF_MT_FORWARD_CUSTOM_NALU),
+        X(MF_MEDIA_ENGINE_BROWSER_COMPATIBILITY_MODE_IE10),
         X(MF_TOPONODE_ERROR_MAJORTYPE),
         X(MF_MT_SECURE),
         X(MFT_FIELDOFUSE_UNLOCK_Attribute),

-- 
2.26.2

